ggplot(data,aes(x=PEMKWH,y=JAMNYALA))+
geom_point(size=5) + geom_line()
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= JAMNYALA)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=DAYA,y= JAMNYALA)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=KWHLWBP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=BLTH,y= RPDISKON)) +
geom_point(aes(col=KWHLWBP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=BLTH,y= RPDISKON)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
ggplot(data,aes(x=PEMKWH,y=KWHLWBP))+
geom_point(size=5) + geom_line()
ggplot(data,aes(x=PEMKWH,y=KWHWBP))+
geom_point(size=5) + geom_line()
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHLWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHLWBP)) +
geom_point(aes(col=NAMA_UP,size=TARIP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHWBP)) +
geom_point(aes(col=NAMA_UP,size=TARIP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMTER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= KWHWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= KWHWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= KWHLWBP)) +
geom_point(aes(col=TARIP,size=KDPEMBMETER))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=DAYA,y= PEMKWH)) +
geom_point(aes(col=NAMA_UP,size=TARIP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= DAYA)) +
geom_point(aes(col=NAMA_UP,size=TARIP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= TARIP)) +
geom_point(aes(col=KDPEMBMETER,size=DAYA))+
geom_smooth(method ="loess", se=F)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= RPPLN)) +
geom_point(aes(col=KDPEMBMETER,size=TARIP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
ggplot(data,aes(x=PEMKWH,y=RPPLN))+
geom_point(size=5) + geom_line()
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= RPPLN)) +
geom_point(aes(col=KWHWBP,size=KWHLWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=DAYA,y= RPPLN)) +
geom_point(aes(col=KWHWBP,size=KWHLWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= RPPLN)) +
geom_point(aes(col=KWHWBP,size=KWHLWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Install Package
install.packages("devtools", dependencies = TRUE)
install.packages("devtools", dependencies = TRUE)
devtools::install_github("hrbrmstr/ggalt")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("data.table")
install.packages("ggalt")
install.packages("ggfortify")
options(scipen =999)
#Library
library(tidyverse)
library(ggplot2)
library(data.table)
library(ggalt)
library(ggfortify)
theme_set(theme_bw())
bisnis3 <- read.delim("C:/Users/radit/Downloads/bisnis3.csv", stringsAsFactors=TRUE)
View(bisnis3)
#Intial Data
data<-data.table(bisnis3)
data5<- data[sample(.N,200000)]
#Basic Scatter Plot
package="ggplot2"
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=KHWWBP,y= RPPLN)) +
geom_point(aes(col=TARIP,size=JAMNYALA))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=KWHWBP,y= RPPLN)) +
geom_point(aes(col=TARIP,size=JAMNYALA))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=KWHWBP,y= RPDISKON)) +
geom_point(aes(col=TARIP,size=JAMNYALA))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=PEMKWH,y= RPDISKON)) +
geom_point(aes(col=TARIP,size=JAMNYALA))+
geom_line(aes(x=KWHWBP,y=KWHLWBP)) +
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= RPDISKON)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= RPDISKON)) +
geom_point(aes(col=TARIP,size=KWHLWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
theme_set(theme_classic())
#Boxplot
ggplot(data5,aes(x=KDPEMBMETER,Y=PEMKWH)) +
geom_boxplot(varwidth = T, fill="plum") +
labs(title="Boxplot",
x="TARIP",
y="METER")
#Boxplot
ggplot(data5,aes(x=NAMA_UP,Y=PEMKWH)) +
geom_boxplot(varwidth = T, fill="plum") +
labs(title="Boxplot",
x="TARIP",
y="METER")
bisnis3 <- read.delim("C:/Users/radit/Downloads/bisnis3.csv", stringsAsFactors=TRUE)
View(bisnis3)
#Install Package
install.packages("devtools", dependencies = TRUE)
install.packages("devtools", dependencies = TRUE)
devtools::install_github("hrbrmstr/ggalt")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("data.table")
install.packages("ggalt")
install.packages("ggfortify")
options(scipen =999)
#Library
library(tidyverse)
library(ggplot2)
library(data.table)
library(ggalt)
library(ggfortify)
theme_set(theme_bw())
bisnis3 <- read.delim("C:/Users/radit/Downloads/bisnis3.csv", stringsAsFactors=TRUE)
View(bisnis3)
#Intial Data
data<-data.table(bisnis3)
data5<- data[sample(.N,200000)]
#Basic Scatter Plot
package="ggplot2"
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=TARIP,y= KWHWBP)) +
geom_point(aes(col=PEMKWH,size=RPPLN))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=TARIP,y= KWHLWBP)) +
geom_point(aes(col=PEMKWH,size=RPPLN))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=TARIP,y= KWHWBP)) +
geom_point(aes(col=PEMKWH,size=RPPLN))+
geom_smooth(method ="loess", se=F)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=TARIP,y= KWHWBP)) +
geom_point(aes(col=PEMKWH,size=RPPLN))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=DAYA,y= TARIP)) +
geom_point(aes(col=PEMKWH,size=RPPLN))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Install Package
install.packages("devtools", dependencies = TRUE)
install.packages("devtools", dependencies = TRUE)
devtools::install_github("hrbrmstr/ggalt")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("data.table")
install.packages("ggalt")
install.packages("ggfortify")
options(scipen =999)
#Library
library(tidyverse)
library(ggplot2)
library(data.table)
library(ggalt)
library(ggfortify)
theme_set(theme_bw())
bisnis3 <- read.delim("C:/Users/radit/Downloads/bisnis3.csv", stringsAsFactors=TRUE)
View(bisnis3)
#Intial Data
data<-data.table(bisnis3)
#Filter data
data1<- filter(data, BLTH == 201901)
data2<- filter(data, BLTH == 201902)
data3<- filter(data, BLTH == 201903)
data4<- filter(data, BLTH == 201904)
data5<- filter(data, BLTH == 201905)
data6<- filter(data, BLTH == 201906)
data7<- filter(data, BLTH == 201907)
data8<- filter(data, BLTH == 201908)
data9<- filter(data, BLTH == 201909)
data10<- filter(data, BLTH == 201910)
data11<- filter(data, BLTH == 201911)
data12<- filter(data, BLTH == 201912)
data13<- filter(data, BLTH == 202001)
data14<- filter(data, BLTH == 202002)
data15<- filter(data, BLTH == 202003)
data16<- filter(data, BLTH == 202004)
data17<- filter(data, BLTH == 202005)
data18<- filter(data, BLTH == 202006)
data19<- filter(data, BLTH == 202007)
data20<- filter(data, BLTH == 202008)
data21<- filter(data, BLTH == 202009)
data22<- filter(data, BLTH == 202010)
data23<- filter(data, BLTH == 202011)
data24<- filter(data, BLTH == 202012)
#Package
package="ggplot2"
#Advanced Scatter Plot
gg1 <- ggplot(data1,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data2,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data3,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data4,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data5,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg1 <- ggplot(data6,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg1)
#Advanced Scatter Plot
gg <- ggplot(data7,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
#Advanced Scatter Plot
gg <- ggplot(data11,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
#Advanced Scatter Plot
gg <- ggplot(data13,aes(x=JAMNYALA,y= DAYA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
#Advanced Scatter Plot
gg <- ggplot(data21,aes(x=DAYA,y= JAMNYALA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
#Advanced Scatter Plot
gg <- ggplot(data19,aes(x=DAYA,y= JAMNYALA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
#Advanced Scatter Plot
gg <- ggplot(data24,aes(x=DAYA,y= JAMNYALA)) +
geom_point(aes(col=TARIP,size=KWHWBP))+
geom_smooth(method ="loess", se=F)
plot(gg)
bisnis3 <- read.delim("C:/Users/radit/Downloads/bisnis3.csv", stringsAsFactors=TRUE)
View(bisnis3)
install.packages("tidyverse")
install.packages("cluster")
install.packages("factoextra")
library(tidyverse)
library(cluster)
library(factoextra)
bisni4 <- read.delim("C:/Users/radit/Downloads/bisni4.csv", stringsAsFactors=TRUE)
View(bisni4)
#Intial Data
data<-data.table(bisni4)
install.packages("data.table")
library(data.table)
#Intial Data
data<-data.table(bisni4)
#Remove Missing Value
data1 <- na.omit(data)
data2<-scale(data1)
data2<-scale(data)
data1 <- select(data,jamnyala)
data1 <- select(data,JAMYALA)
data1 <- data("JAMNYALA","IDPEL")
View(data1)
View(data)
data1 <- data(JAMNYALA,IDPEL)
#Filter Coloumn
data1<- data[sample(("IDPEL","JAMNYALA")]
data1<-subset(data,select = c(IDPEL,JAMNYALA,PEMKWH))
View(data1)
#Filter Coloumn
data1<-subset(data,select = c(DAYA,KWHLWBP,KWHWBP))
#Sample Row
data2<- data1[sample(.N,200000)]
#Filter Condition
data3<- filter(data, BLTH == 202007)
data4<-subset(data3,select = c(DAYA,KWHLWBP,KWHWBP))
#Remove Missing Value
data5<-na.omit(data4)
data6<-na.omit(data2)
#Scale
data7<- scale(data6)
head(data7)
View(data7)
data8<-na.omit(data1)
#Scale
data9<- scale(data8)
head(data9)
View(data9)
#Clustering Distance Measure
distance <- get_dist(data7)
#Clustering Distance Measure
distance <- get_dist(data9)
#Scale
data10 <- scale(data5)
#Clustering Distance Measure
distance <- get_dist(data10)
fviz_dist(distance, gradient = list(low = "#00AFBB",
mid = "white", high = "#FC4E07"))
#K-Means Clustering
k2 <- kmeans(data7, centers = 2, nstart = 25)
str(k2)
k2
#Cluster Plot
fviz_cluster(k2, data = data7)
#Alternative Cluster Plot
df %>%
df %>%
as_tibble() %>%
mutate(cluster = k2$cluster,
state = row.names(data7)) %>%
ggplot(aes(DAYA, KWHLWBP, color = factor(cluster), label = KWHWBP)) +
geom_text()
data7 %>%
as_tibble() %>%
mutate(cluster = k2$cluster,
state = row.names(data7)) %>%
ggplot(aes(DAYA, KWHLWBP, color = factor(cluster), label = KWHWBP)) +
geom_text()
install.packages("gridExtra")
library(gridExtra)
k3 <- kmeans(data7, centers = 3, nstart = 25)
k4 <- kmeans(data7, centers = 4, nstart = 25)
k5 <- kmeans(data7, centers = 5, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = data7) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = data7) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = data7) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = df) + ggtitle("k = 5")
grid.arrange(p1, p2, p3, p4, nrow = 2)
p4 <- fviz_cluster(k5, geom = "point",  data = data7) + ggtitle("k = 5")
grid.arrange(p1, p2, p3, p4, nrow = 2)
set.seed(123)
wss <- function(k) {
kmeans(data7, k, nstart = 10 )$tot.withinss
}
# Compute and plot wss for k = 1 to k = 15
k.values <- 1:15
# extract wss for 2-15 clusters
wss_values <- map_dbl(k.values, wss)
plot(k.values, wss_values,
type="b", pch = 19, frame = FALSE,
xlab="Number of clusters K",
ylab="Total within-clusters sum of squares")
set.seed(123)
fviz_nbclust(data7, kmeans, method = "wss")
fviz_nbclust(data10, kmeans, method = "wss")
avg_sil <- function(k) {
km.res <- kmeans(data7, centers = k, nstart = 25)
ss <- silhouette(km.res$cluster, dist(data7))
mean(ss[, 3])
}
# Compute and plot wss for k = 2 to k = 15
k.values <- 2:15
# extract avg silhouette for 2-15 clusters
avg_sil_values <- map_dbl(k.values, avg_sil)
plot(k.values, avg_sil_values,
type = "b", pch = 19, frame = FALSE,
xlab = "Number of clusters K",
ylab = "Average Silhouettes")
# function to compute average silhouette for k clusters
avg_sil <- function(k) {
km.res <- kmeans(data10, centers = k, nstart = 25)
ss <- silhouette(km.res$cluster, dist(data10))
mean(ss[, 3])
}
# Compute and plot wss for k = 2 to k = 15
k.values <- 2:15
# extract avg silhouette for 2-15 clusters
avg_sil_values <- map_dbl(k.values, avg_sil)
plot(k.values, avg_sil_values,
type = "b", pch = 19, frame = FALSE,
xlab = "Number of clusters K",
ylab = "Average Silhouettes")
#Optimal Number Cluster
fviz_nbclust(data10, kmeans, method = "silhouette")
set.seed(123)
gap_stat <- clusGap(data7, FUN = kmeans, nstart = 25,
K.max = 10, B = 50)
gap_stat <- clusGap(data10, FUN = kmeans, nstart = 25,
K.max = 10, B = 50)
# Print the result
print(gap_stat, method = "firstmax")
fviz_gap_stat(gap_stat)
#Final
set.seed(123)
final <- kmeans(data7, 9, nstart = 25)
print(final)
fviz_cluster(final, data = data7)
set.seed(123)
final <- kmeans(data7, 7, nstart = 25)
print(final)
fviz_cluster(final, data = data7)
#Final
set.seed(123)
final <- kmeans(data7, 2, nstart = 25)
print(final)
final <- kmeans(data7, 3, nstart = 25)
print(final)
final <- kmeans(data7, 4, nstart = 25)
print(final)
final <- kmeans(data10, 4, nstart = 25)
print(final)
final <- kmeans(data7, 5, nstart = 25)
print(final)
final <- kmeans(data7, 6, nstart = 25)
print(final)
final <- kmeans(data7, 8, nstart = 25)
print(final)
final <- kmeans(data7, 10, nstart = 25)
print(final)
final <- kmeans(data7, 1, nstart = 25)
print(final)
final <- kmeans(data7, 9, nstart = 25)
print(final)
